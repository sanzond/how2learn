# 学习流程设计文档

## 1. 总体流程架构
```
生单词听50遍 → 句子听50遍 → 词汇练习100分 → 句子理解完成
```

## 2. 各阶段详细设计

### 阶段一：生单词听力训练（50遍）
**目标**：每个单词累计播放50次
**现有基础**：VocabularyLearning组件已具备循环播放功能，vocabularyTrackingManager可记录播放次数
**需要修改**：
- 在VocabularyLearning中添加播放次数阈值检查（50次）
- 添加阶段完成状态管理
- 扩展vocabularyTrackingManager支持阶段进度跟踪

### 阶段二：句子听力训练（50遍）
**目标**：每个句子累计播放50次
**现有基础**：FullSentenceDisplay组件已具备循环播放功能，sentenceTrackingManager可记录播放次数
**需要修改**：
- 在FullSentenceDisplay中添加播放次数阈值检查（50次）
- 添加阶段完成状态管理
- 扩展sentenceTrackingManager支持阶段进度跟踪

### 阶段三：词汇练习（100分）
**目标**：词汇掌握度达到100分（10分制）
**现有基础**：VocabularyLearning组件已具备Rescorla-Wagner算法掌握度计算
**需要修改**：
- 添加分数阈值检查（达到10分）
- 扩展掌握度计算支持100分制
- 添加阶段完成验证逻辑

### 阶段四：句子理解完成
**目标**：完成所有句子的理解训练
**现有基础**：SentenceLearning组件已具备句子理解训练流程
**需要修改**：
- 添加句子理解完成状态跟踪
- 扩展阶段完成验证逻辑

## 3. 流程控制机制设计

### 前置条件检查
- 每个阶段完成后才能进入下一阶段
- 在App.tsx中添加LearningProgressManager管理整体进度
- 实现阶段切换的验证逻辑

### 进度同步机制
- 使用现有的localStorageManager进行进度持久化
- 新增LearningProgress接口管理整体学习进度
- 实现进度恢复和断点续学功能

## 4. 需要新增的数据模型

### LearningProgress接口
```typescript
interface LearningProgress {
  currentStage: 'word_listening' | 'sentence_listening' | 'vocabulary_practice' | 'sentence_comprehension';
  completedStages: string[];
  wordListeningProgress: Record<string, number>; // 单词播放次数
  sentenceListeningProgress: Record<string, number>; // 句子播放次数
  vocabularyPracticeProgress: Record<string, number>; // 词汇掌握度分数
  sentenceComprehensionProgress: Record<string, boolean>; // 句子理解完成状态
  startTime: number;
  lastUpdateTime: number;
}
```

### StageValidator类
负责验证各阶段完成条件：
- 单词听力：所有单词播放次数≥50
- 句子听力：所有句子播放次数≥50  
- 词汇练习：所有词汇掌握度≥10分
- 句子理解：所有句子理解完成

## 5. 考核统计设计

### 统计指标
- **完成率**：各阶段完成百分比
- **播放次数**：单词/句子累计播放次数
- **掌握度**：词汇掌握度分数分布
- **学习时间**：各阶段耗时统计
- **错误率**：练习过程中的错误统计

### 统计展示
- 在SentenceStatistics组件中扩展统计功能
- 添加阶段进度可视化图表
- 支持导出学习报告

## 6. 需要修改的代码模块

### 新增模块
1. **LearningProgressManager**：管理整体学习进度
2. **StageValidator**：验证阶段完成条件
3. **ProgressVisualization**：进度可视化组件

### 修改现有模块
1. **App.tsx**：集成流程控制逻辑
2. **VocabularyLearning.tsx**：添加阶段检查和进度跟踪
3. **FullSentenceDisplay.tsx**：扩展播放次数统计
4. **SentenceLearning.tsx**：添加理解完成状态
5. **SentenceStatistics.tsx**：扩展考核统计功能

## 7. 实现优先级

**高优先级**：
- 学习进度管理接口
- 阶段完成验证逻辑
- 基础考核统计功能

**中优先级**：
- 进度可视化界面
- 详细统计报告
- 断点续学功能

**低优先级**：
- 学习报告导出
- 高级分析功能
- 个性化推荐

该设计文档基于现有代码架构，充分利用了已有的播放统计和掌握度计算功能，通过添加流程控制和考核统计来实现严格的学习顺序要求。